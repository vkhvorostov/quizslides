# Use Cases: QuizSlides

---

## Use Case 1: Запуск живой сессии презентации

| Элемент | Описание |
| :--- | :--- |
| **Название** | Запуск живой сессии презентации |
| **Актор** | Презентатор, Участник |
| **Основной сценарий** | 1. Презентатор открывает созданную презентацию и нажимает кнопку **«Present»**.<br>2. Система переводит презентацию в статус **«Active»** и генерирует уникальный 6-значный код доступа.<br>3. Система открывает экран демонстрации с кодом и QR-кодом.<br>4. Участник заходит на главную страницу сайта и вводит код доступа.<br>5. Система проверяет существование активной сессии с таким кодом.<br>6. Система устанавливает WebSocket-соединение с устройством Участника.<br>7. Система определяет текущий активный слайд Презентатора.<br>8. Система отображает на устройстве Участника интерфейс, соответствующий типу текущего слайда. |
| **Альт. сценарии** | **Альт.1: Неверный код** (ветвление от шага 5).<br>5a. Система сообщает: *«Код не найден или сессия завершена»*.<br>5b. Участник остается на странице ввода кода.<br>**Альт.2: Требуется имя** (ветвление от шага 6).<br>6a. Система видит в настройках презентации флаг **«Identify participants»**.<br>6b. Система отображает Участнику форму ввода имени перед допуском к контенту. |
| **Негативный сценарий** | **Превышение лимита подключений** (вариант на шаге 5).<br>5a. Система определяет, что достигнут лимит участников для текущего тарифного плана владельца.<br>5b. Система выводит сообщение *«Комната заполнена»* и закрывает доступ новым участникам. |
| **Конечное состояние** | Презентатор видит количество подключенных участников; Участник видит актуальный контент первого слайда на своем экране. |

---

## Use Case 2: Проведение интерактивного опроса (Multiple Choice)

| Элемент | Описание |
| :--- | :--- |
| **Название** | Сбор ответов и визуализация результатов опроса |
| **Актор** | Участник, Презентатор, Система |
| **Основной сценарий** | 1. Презентатор переключается на слайд типа **«Опрос»**.<br>2. Система через WebSocket рассылает всем подключенным Участникам команду отобразить форму голосования.<br>3. Участник выбирает один из предложенных вариантов и нажимает **«Отправить»**.<br>4. Система проверяет, не истекло ли время на голосование (таймер).<br>5. Система сохраняет голос в БД, привязывая его к сессии и слайду.<br>6. Система пересчитывает агрегированную статистику ответов в реальном времени.<br>7. Система транслирует обновленные данные (проценты/столбцы) на главный экран Презентатора.<br>8. Система отображает Участнику экран подтверждения *«Голос принят»*. |
| **Альт. сценарии** | **Альт.1: Изменение выбора** (ветвление от шага 3).<br>3a. Если в настройках разрешена смена ответа, Участник нажимает **«Undo»**.<br>3b. Система удаляет предыдущую запись и возвращает к шагу 3. |
| **Негативный сценарий** | **Повторное голосование** (вариант на шаге 4).<br>4a. Система обнаруживает по сессионному ключу/ID, что Участник уже голосовал.<br>4b. Система блокирует кнопку отправки и выводит предупреждение *«Вы уже проголосовали»*. |
| **Конечное состояние** | В БД зафиксированы ответы; на экране Презентатора отображается динамически изменившаяся диаграмма. |

---

## Use Case 3: Работа сессии Вопросов и Ответов (Q&A)

| Элемент | Описание |
| :--- | :--- |
| **Название** | Управление входящими вопросами от аудитории |
| **Актор** | Участник, Презентатор |
| **Основной сценарий** | 1. Участник нажимает на иконку **«Задать вопрос»** в интерфейсе сессии.<br>2. Участник вводит текст вопроса и подтверждает отправку.<br>3. Система проверяет текст на наличие запрещенных слов (фильтр мата).<br>4. Система сохраняет вопрос со статусом **«Опубликован»**.<br>5. Система мгновенно отображает вопрос в списке на устройствах других Участников и Презентатора.<br>6. Другие Участники нажимают кнопку **«Like»** под вопросом.<br>7. Система ранжирует список вопросов по количеству лайков.<br>8. Презентатор выбирает вопрос и нажимает **«Ответить»**.<br>9. Система подсвечивает этот вопрос на главном экране для всей аудитории. |
| **Альт. сценарии** | **Альт.1: Пре-модерация** (ветвление от шага 4).<br>4a. Если включена модерация, Система сохраняет вопрос со статусом **«Pending»**.<br>4b. Вопрос виден только Презентатору; он нажимает **«Approve»**.<br>4c. Система переходит к шагу 5 основного сценария. |
| **Негативный сценарий** | **Дублирование вопроса** (вариант на шаге 3).<br>3a. Система находит идентичный вопрос, заданный ранее.<br>3b. Система предлагает Участнику просто поставить лайк уже существующему вопросу вместо создания дубля. |
| **Конечное состояние** | Вопрос обработан; аудитория видит актуальный топ вопросов; Презентатор управляет фокусом внимания. |

---

## Use Case 4: Импорт презентации из PDF-файла

| Элемент | Описание |
| :--- | :--- |
| **Название** | Конвертация PDF-документа в набор слайдов |
| **Актор** | Презентатор |
| **Основной сценарий** | 1. Презентатор нажимает **«Import»** в личном кабинете.<br>2. Презентатор выбирает PDF-файл на локальном устройстве.<br>3. Система проверяет размер и формат файла.<br>4. Система загружает файл в хранилище (Media storage).<br>5. Система создает фоновую задачу на обработку файла (постраничный рендеринг).<br>6. Система создает новую презентацию в БД.<br>7. Для каждой страницы PDF система создает объект **Slide** с типом **«Content»**.<br>8. Система уведомляет пользователя о завершении импорта. |
| **Альт. сценарии** | **Альт.1: Добавление в существующую презентацию** (ветвление от шага 6).<br>6a. Пользователь выбирает «Добавить к текущей».<br>6b. Слайды создаются в конце существующего списка. |
| **Негативный сценарий** | **Ошибка обработки** (вариант на шаге 5).<br>5a. PDF защищен паролем или поврежден.<br>5b. Система прерывает задачу и выводит сообщение: *«Не удалось обработать файл. Проверьте отсутствие защиты паролем»*. |
| **Конечное состояние** | Создана структура слайдов в Django, где каждый слайд — это статичное изображение из PDF, готовое к добавлению интерактивных слоев. |

---

## Use Case 5: Викторина (Quiz) с определением победителя

| Элемент | Описание |
| :--- | :--- |
| **Название** | Проведение соревновательного раунда |
| **Актор** | Участник, Презентатор, Система |
| **Основной сценарий** | 1. Презентатор запускает слайд типа **«Quiz»**.<br>2. Система запускает на экранах Участников обратный отсчет (напр. 15 сек).<br>3. Участник нажимает на правильный ответ.<br>4. Система фиксирует время ответа с точностью до миллисекунд.<br>5. По окончании таймера Система проверяет ответы.<br>6. Система начисляет баллы: базовые за правильность + бонус за скорость.<br>7. Система обновляет общую таблицу лидеров (**Leaderboard**).<br>8. Система отображает на главном экране топ-5 игроков с анимацией. |
| **Альт. сценарии** | **Альт.1: Досрочное завершение** (ветвление от шага 2).<br>2a. Презентатор нажимает **«Stop»** до истечения таймера.<br>2b. Система немедленно переходит к шагу 5. |
| **Негативный сценарий** | **Сбой связи у Участника** (вариант на шаге 3).<br>3a. Ответ доставлен на сервер после закрытия таймера из-за лагов сети.<br>3b. Система помечает ответ как **«Late»** и начисляет 0 баллов. |
| **Конечное состояние** | Баллы распределены в БД (модель **ParticipantScore**); определен текущий лидер сессии. |

---

## Use Case 6: Создание и настройка слайда типа «Облако слов»

| Элемент | Описание |
| :--- | :--- |
| **Название** | Проектирование слайда для генерации облака тегов |
| **Актор** | Презентатор |
| **Основной сценарий** | 1. Презентатор в конструкторе нажимает **«Добавить слайд»** и выбирает **«Word Cloud»**.<br>2. Система создает новый объект в БД и открывает панель настроек.<br>3. Презентатор вводит основной вопрос (например, *«Опишите проект одним словом»*).<br>4. Презентатор устанавливает лимит: сколько слов может отправить один участник.<br>5. Презентатор включает тумблер **«Filter Profanity»** (фильтрация мата).<br>6. Система автоматически сохраняет изменения в фоне через AJAX/Fetch запрос.<br>7. Система обновляет миниатюру слайда в списке презентации. |
| **Альт. сценарии** | **Альт.1: Загрузка фонового изображения** (ветвление от шага 4).<br>4a. Презентатор выбирает загрузку фото.<br>4b. Система проверяет формат и сохраняет файл в Media-директорию Django.<br>4c. Система отображает превью изображения как фон для будущего облака слов. |
| **Негативный сценарий** | **Превышение лимита слайдов** (вариант на шаге 1).<br>1a. Система проверяет подписку пользователя и количество уже созданных слайдов.<br>1b. Система блокирует создание и предлагает удалить старые слайды или перейти на PRO-тариф. |
| **Конечное состояние** | Слайд настроен, параметры валидированы и сохранены в БД (модель **Slide**). |

---

## Use Case 7: Реальное взаимодействие: Отправка слов в облако

| Элемент | Описание |
| :--- | :--- |
| **Название** | Участие в формировании динамического облака слов |
| **Акторы** | Участник, Система |
| **Основной сценарий** | 1. Система отображает на устройстве Участника текстовые поля ввода (согласно лимиту из UC 6).<br>2. Участник вводит слова и нажимает **«Submit»**.<br>3. Система проверяет слова на соответствие фильтру ненормативной лексики.<br>4. Система сохраняет каждое слово как отдельную запись в БД, связанную с текущей сессией.<br>5. Система отправляет сигнал через Django Channels (WebSocket) на экран Презентатора.<br>6. Система на экране Презентатора мгновенно перерисовывает облако (увеличивая размер повторяющихся слов). |
| **Альт. сценарии** | **Альт.1: Пустой ввод** (ветвление от шага 2).<br>2a. Участник нажимает отправить, не заполнив поля.<br>2b. Система подсвечивает поля красным и выводит: *«Введите хотя бы одно слово»*. |
| **Негативный сценарий** | **Смена активного слайда** (вариант на шаге 3).<br>3a. Пока Участник писал, Презентатор переключил слайд.<br>3b. Система отклоняет запрос и уведомляет: *«Презентатор сменил слайд, голосование окончено»*. |
| **Конечное состояние** | Слова добавлены в общую визуализацию, Участник видит сообщение об успехе. |

---

## Use Case 8: Управление профилем и тарифным планом

| Элемент | Описание |
| :--- | :--- |
| **Название** | Обновление аккаунта до платной версии |
| **Актор** | Презентатор |
| **Основной сценарий** | 1. Презентатор переходит в раздел **«Billing»**.<br>2. Презентатор выбирает тариф (например, «Education») и нажимает **«Upgrade»**.<br>3. Система формирует транзакцию и перенаправляет на страницу платежного шлюза.<br>4. Презентатор вводит данные и подтверждает оплату.<br>5. Система получает уведомление (Webhook) от платежной системы об успехе.<br>6. Система меняет статус пользователя в БД (`is_pro = True`) и обновляет лимиты участников. |
| **Альт. сценарии** | **Альт.1: Использование промокода** (ветвление от шага 2).<br>2a. Презентатор вводит промокод.<br>2b. Система проверяет его в БД и пересчитывает сумму в корзине перед шагом 3. |
| **Негативный сценарий** | **Отказ в транзакции** (вариант на шаге 5).<br>5a. Система получает статус «Error» или «Cancelled» от шлюза.<br>5b. Система возвращает пользователя в раздел Billing с уведомлением *«Платеж отклонен банком»*. |
| **Конечное состояние** | Статус пользователя обновлен, расширенные функции Django-приложения стали доступны. |

---

## Use Case 9: Просмотр и фильтрация результатов в Личном кабинете

| Элемент | Описание |
| :--- | :--- |
| **Название** | Аналитика прошедшей презентации |
| **Актор** | Презентатор |
| **Основной сценарий** | 1. Презентатор открывает раздел **«My Presentations»** -> **«History»**.<br>2. Презентатор выбирает конкретную прошедшую дату/сессию.<br>3. Система извлекает из БД все связанные ответы (**Votes**, **Responses**).<br>4. Система отображает таблицу с участниками и их результатами в викторинах.<br>5. Презентатор применяет фильтр **«Только правильные ответы»**.<br>6. Система пересчитывает выборку и обновляет таблицу без перезагрузки страницы. |
| **Альт. сценарии** | **Альт.1: Анонимная сессия** (ветвление от шага 4).<br>4a. Если презентация была анонимной, Система заменяет имена на «Participant 1, 2...». |
| **Негативный сценарий** | **Данные удалены** (вариант на шаге 3).<br>3a. Презентатор ранее выполнил «Reset Results».<br>3b. Система выводит сообщение: *«История этой сессии была очищена»*. |
| **Конечное состояние** | Презентатор получил необходимые данные для анализа эффективности выступления. |

---

## Use Case 10: Реализация «Leaderboard» (Доска лидеров)

| Элемент | Описание |
| :--- | :--- |
| **Название** | Демонстрация промежуточных итогов викторины |
| **Акторы** | Презентатор, Система |
| **Основной сценарий** | 1. Презентатор нажимает кнопку **«Show Leaderboard»**.<br>2. Система выполняет агрегирующий запрос к БД: суммирует баллы всех Участников по текущей презентации.<br>3. Система сортирует Участников по убыванию баллов.<br>4. Система выбирает ТОП-5 (или ТОП-10) записей.<br>5. Система отправляет JSON-данные через WebSocket на экран демонстрации.<br>6. Фронтенд-скрипт запускает анимацию появления имен и набранных очков. |
| **Альт. сценарии** | **Альт.1: Ничья** (ветвление от шага 3).<br>3a. Несколько участников имеют равные баллы.<br>3b. Система дополнительно сортирует их по времени последнего ответа (кто быстрее — тот выше). |
| **Негативный сценарий** | **Отсутствие участников** (вариант на шаге 2).<br>2a. На викторину еще никто не ответил.<br>2b. Система выводит на экран сообщение *«Waiting for responses...»* вместо пустой таблицы. |
| **Конечное состояние** | Аудитория видит соревновательный прогресс, что повышает вовлеченность. |
